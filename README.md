# goreportx

[![CI](https://github.com/ozgen/goreportx/actions/workflows/ci.yml/badge.svg)](https://github.com/ozgen/goreportx/actions/workflows/ci.yml)
[![Release](https://img.shields.io/github/v/tag/ozgen/goreportx?label=release&sort=semver)](https://github.com/ozgen/goreportx/releases)
[![Go Report Card](https://goreportcard.com/badge/github.com/ozgen/goreportx)](https://goreportcard.com/report/github.com/ozgen/goreportx)
[![codecov](https://codecov.io/gh/ozgen/goreportx/branch/main/graph/badge.svg)](https://codecov.io/gh/ozgen/goreportx)


**goreportx** is a lightweight Go library to generate PDF and JSON reports from structured data using HTML-like templates.
It supports multiple layouts, base64-embedded charts and logos, dynamic multi-column tables, and optional timestamp injection.

---

## Features

* Render structured reports to **PDF** and **JSON**
* Embed charts and logos using **base64 images**
* HTML-like template support (`h1`, `table`, `img`, `p`, etc.)
* Dynamic multi-column and chart-based report layouts
* Optional **timestamp** support (PDF top-right, JSON footer)
* Clean, modular **RendererInterface**
* Output to file or return as byte buffer
* CLI support planned

---

## Installation

```bash
go get github.com/ozgen/goreportx
```

---

## Usage

### Render a basic report using PDF and JSON renderer

```go
tmpl := template.Must(template.ParseFiles("internal/template/defaults/smart_template_new.html"))

factory := core.NewRendererFactory().
  WithFontSizes(core.FontSizes{H1: 24, H2: 18, H3: 14, P: 12, Footer: 10}).
  WithPageNumbers(true).
  WithHeaderImage(core.LoadImageBase64("assets/header_footer.png")).
  WithFooterImage(core.LoadImageBase64("assets/header_footer.png"))

report := models.Report{
  Header: models.Header{Title: "Smart Report", Subtitle: "Q2", Explanation: "Auto-generated"},
  Footer: models.Footer{Note: "Generated by goreportx"},
  Data: map[string]string{"Project": "AI Dashboard", "Status": "Complete"},
  Charts: []models.Chart{{
    Title: "Usage Overview",
    Description: "Chart showing usage trends",
    Tag: core.WrapChartAsHTML(chartBase64, core.AlignCenter),
  }},
}

pdfRenderer := pdf.NewPDFRenderer(report, tmpl, factory).
  WithTimestamp(true).
  SetTimestampFormat("2006-01-02 15:04")

pdfRenderer.Render("output.pdf")

jsonRenderer := json.NewJSONRenderer(report).
  WithTimestamp(true).
  SetTimestampFormat("2006-01-02 15:04")

jsonRenderer.Render("output.json")
```

---

## Examples

Examples are available under:

```
examples/basic_report/main.go
examples/simple_report/main.go
examples/multiple_columns/main.go
examples/multiple_charts/main.go
```

Output files will be saved to:

```
examples/outputs/
```

---

## Templates

Templates use Go's `html/template` syntax:

```html
<h1>{{ .Header.Title }}</h1>
<p>{{ .Footer.Note }}</p>
{{ range .Charts }}{{ .Tag }}{{ end }}
```

---

## Supported Tags in Templates

* `<h1>`, `<h2>`, `<h3>`
* `<p>` — supports `<strong>` and `<em>`
* `<table>`, `<th>`, `<td>`
* `<img src="data:image/...">`
* `<br>` — for line spacing

---

## Timestamp Support

```go
renderer.WithTimestamp(true).SetTimestampFormat("2006-01-02 15:04")
```

* PDF: shown top-right of every page
* JSON: appended to `Footer.Note`

---

## Folder Structure

```
/assets/                     → Fonts and images (logo, headers)
/cmd/                        → CLI entry point (planned)
/examples/
  basic_report/              → Main report demo
  multiple_columns/          → Multi-column tables
  multiple_charts/           → Chart grid example
  simple_report/             → Minimal report
  outputs/                   → Generated sample files
/internal/
  core/                      → PDF engine, renderers, helpers
  models/                    → Report data models
  renderer/pdf/              → PDFRenderer (template + factory)
  renderer/json/             → JSONRenderer
  template/defaults/         → HTML-like report templates
```

---

## CLI Usage

You can use `goreportx` from the command line to generate PDF or JSON reports from a data file and an HTML template.

### Required Flags

* `--input`: Path to the JSON file containing report data
* `--template`: Path to the HTML template
* `--format`: `pdf` or `json`

### Optional Flags

* `--output`: Output file name (default: `output.pdf` or `output.json`)
* `--headerImage`: Path to header image (base64 encoded internally)
* `--footerImage`: Path to footer image
* `--baseImage`: Path to background image
* `--with-timestamp`: Include timestamp (boolean)
* `--time-format`: Timestamp format (default: `"2006-01-02 15:04:05"`)
* `--showPageNumber`: Enable/disable page numbers (PDF only, default: true)

---

### Example: Generate a PDF

```bash
go run cmd/goreportx/main.go \
  --input examples/outputs/sample.json \
  --template internal/template/defaults/smart_template_new.html \
  --format pdf \
  --output examples/outputs/generated.pdf \
  --headerImage assets/header_footer.png \
  --footerImage assets/header_footer.png \
  --with-timestamp \
  --time-format "2006-01-02"
```

---

### Example: Generate a JSON Report

```bash
go run cmd/goreportx/main.go \
  --input examples/outputs/sample.json \
  --template internal/template/defaults/smart_template_new.html \
  --format json \
  --output examples/outputs/generated.json \
  --with-timestamp
```

---
###  How to Use Makefile

From the terminal in the root directory:

```bash
make            # build binary
make test       # run unit tests
make cover      # run tests + show HTML coverage
make run        # run CLI with sample args
make install    # install locally
make clean      # cleanup
make fmt        # format source files
```

---

## Documentation

* [Project Wiki](https://github.com/ozgen/goreportx/wiki) — Guide to usage, templates, and examples
* [Templating](https://github.com/ozgen/goreportx/wiki/Templating-in-goreportx)
* [Data Models](https://github.com/ozgen/goreportx/wiki/Data-Models)

---

## License

Apache License 2.0 © 2025 [ozgen](https://github.com/ozgen)
